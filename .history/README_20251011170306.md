# AI 写作助手 ✍️

> 基于 DeepSeek API 的智能写作工具，支持自动生成大纲和分段写作

![License](https://img.shields.io/badge/license-MIT-blue.svg)
![Python](https://img.shields.io/badge/python-3.8+-green.svg)
![Node](https://img.shields.io/badge/node-16+-green.svg)
![Docker](https://img.shields.io/badge/docker-ready-blue.svg)

[快速开始](QUICKSTART.md) | [快速部署](QUICKDEPLOY.md) | [详细部署指南](DEPLOYMENT.md) | [详细配置](SETUP.md) | [项目总结](PROJECT_SUMMARY.md)

## ✨ 功能特点

- 🎯 **智能大纲生成**：输入主题，AI 自动生成结构化的文章大纲
- ✏️ **可编辑大纲**：支持对生成的大纲进行自由编辑和修改
- 📝 **分段写作**：根据大纲的每个章节自动生成内容
- 🔄 **两种生成模式**：
  - **依次生成模式**：每生成一段后需要用户确认再继续
  - **一次性生成模式**：自动连续生成所有内容
- 🧠 **上下文感知**：生成时考虑已生成的内容，保持文章连贯性
- 👁️ **实时预览**：支持 Markdown 格式的实时预览
- 💾 **导出功能**：支持复制到剪贴板和下载为 Markdown 文件
- 🚀 **一键部署**：支持 Docker、Vercel、Railway 等多种部署方式

## 技术栈

### 后端
- Python 3.8+
- Flask - Web 框架
- OpenAI SDK - DeepSeek API 调用
- Flask-CORS - 跨域支持

### 前端
- React 18
- TypeScript
- React Markdown - Markdown 渲染

## 安装和运行

### 前置要求

- Python 3.8 或更高版本
- Node.js 16 或更高版本
- DeepSeek API Key（[获取地址](https://platform.deepseek.com/)）

### 后端设置

1. 进入后端目录：
```bash
cd backend
```

2. 安装依赖：
```bash
pip install -r requirements.txt
```

3. 设置环境变量：
```bash
# Windows
set DEEPSEEK_API_KEY=your-deepseek-api-key-here

# Linux/Mac
export DEEPSEEK_API_KEY=your-deepseek-api-key-here
```

或者在 `backend/app.py` 中直接修改 `DEEPSEEK_API_KEY` 变量。

4. 启动后端服务：
```bash
python app.py
```

后端服务将在 `http://localhost:5000` 启动。

### 前端设置

1. 进入前端目录：
```bash
cd frontend
```

2. 安装依赖：
```bash
npm install
```

3. 启动前端开发服务器：
```bash
npm start
```

前端应用将在 `http://localhost:3000` 启动并自动打开浏览器。

## 🚀 部署到公网

### 快速部署（5分钟）

**方式 1: Docker 一键部署**
```bash
# Windows
deploy_docker.bat

# Linux/Mac
chmod +x deploy_docker.sh && ./deploy_docker.sh
```

**方式 2: 免费云平台（推荐）**
- **后端**: [Railway](https://railway.app) - 自动检测并部署
- **前端**: [Vercel](https://vercel.com) - 零配置部署

详细步骤请查看 **[快速部署指南](QUICKDEPLOY.md)** 或 **[完整部署文档](DEPLOYMENT.md)**

### 部署选项对比

| 方式 | 难度 | 成本 | 适用场景 |
|------|------|------|---------|
| Docker 本地 | ⭐ | 免费 | 本地测试、内网使用 |
| Vercel + Railway | ⭐⭐ | 免费额度 | 个人项目、小流量 |
| 云服务器 (VPS) | ⭐⭐⭐ | $5-20/月 | 商业项目、高流量 |
| Kubernetes | ⭐⭐⭐⭐⭐ | 按需 | 企业级应用 |

## 使用方法

1. **输入主题**：在左侧面板的输入框中输入您想要写作的主题
2. **生成大纲**：点击"生成大纲"按钮，AI 将自动创建文章大纲
3. **编辑大纲**：在右侧的编辑器中查看和修改生成的大纲
4. **选择生成模式**：
   - 选择"依次生成"可以在每段生成后手动确认
   - 选择"一次性生成"将自动生成所有内容
5. **开始生成**：点击"开始生成内容"按钮，AI 将根据大纲创作文章
6. **查看和导出**：
   - 在"内容"标签页查看生成的文章
   - 在"预览"标签页查看渲染后的效果
   - 使用工具栏的按钮复制或下载内容

## 项目结构

```
.
├── backend/                # 后端代码
│   ├── app.py             # Flask 应用主文件
│   └── requirements.txt   # Python 依赖
├── frontend/              # 前端代码
│   ├── public/           # 静态资源
│   ├── src/
│   │   ├── components/   # React 组件
│   │   │   ├── LeftPanel.tsx
│   │   │   ├── LeftPanel.css
│   │   │   ├── RightPanel.tsx
│   │   │   └── RightPanel.css
│   │   ├── App.tsx       # 主应用组件
│   │   ├── App.css
│   │   ├── index.tsx     # 入口文件
│   │   └── index.css
│   ├── package.json      # Node 依赖
│   └── tsconfig.json     # TypeScript 配置
├── CoT Augmented Smart LLM.py  # 原始 Pipeline（参考）
└── README.md             # 项目说明
```

## API 接口

### 生成大纲
- **URL**: `/api/generate-outline`
- **Method**: `POST`
- **Body**: `{ "topic": "主题内容" }`
- **Response**: `{ "outline": "生成的大纲" }`

### 生成章节内容
- **URL**: `/api/generate-section`
- **Method**: `POST`
- **Body**: 
```json
{
  "topic": "主题内容",
  "outline": "完整大纲",
  "current_section": "当前章节",
  "previous_content": "已生成的内容"
}
```
- **Response**: Server-Sent Events (SSE) 流式响应

### 健康检查
- **URL**: `/api/health`
- **Method**: `GET`
- **Response**: `{ "status": "ok" }`

## 特性说明

### 长上下文处理

参考 `Diligent LLM` 的设计理念，当已生成的内容较长时（超过 3000 字符），系统会自动：
1. 对之前的内容进行摘要
2. 只保留最相关的上下文信息
3. 确保 API 调用不超过 token 限制

这样可以在处理长文章时保持性能和质量。

### 分段生成策略

借鉴 `CoT Augmented Smart LLM` 的思想：
1. 先生成整体大纲（Chain of Thought）
2. 按大纲逐段生成内容
3. 每段生成时考虑整体结构和已生成内容
4. 避免重复，保持连贯性

## 注意事项

- 确保 DeepSeek API Key 有效且有足够的配额
- 首次运行前端时需要安装依赖，可能需要几分钟
- 生成内容的质量取决于输入的主题描述
- 建议在大纲生成后适当编辑以获得更好的结果

## 许可证

MIT License

## 贡献

欢迎提交 Issue 和 Pull Request！

## 致谢

- 基于 [CoT Augmented Smart LLM](https://github.com/grapoet/) 的设计理念
- 使用 [DeepSeek API](https://platform.deepseek.com/) 提供 AI 能力

