# 功能更新说明

## 新增功能

本次更新添加了两个重要的提示词编辑功能，让用户可以完全自定义AI的生成行为。

### 1. 大纲生成提示词编辑

**位置**: 左侧面板，主题输入框下方

**功能说明**:
- 点击 "▶ 大纲生成提示词" 展开/收起提示词编辑区域
- 可以自定义大纲生成的提示词，而不使用后端默认的提示词
- 使用 `{topic}` 作为主题占位符，系统会自动替换为实际输入的主题
- 点击 🔄 按钮可以重置为默认提示词

**使用示例**:
```
你是一位专业的技术文档写作专家。用户想要写一篇关于"{topic}"的技术文章。

请生成一个技术性强、结构严谨的大纲：
1. 包含技术背景和原理
2. 涵盖实际应用案例
3. 提供最佳实践建议
4. 使用 Markdown 格式（## 和 ### 标记）

只返回大纲内容，以 Markdown 格式输出。
```

### 2. 段落生成提示词编辑

**位置**: 左侧面板，生成模式选择下方

**功能说明**:
- 点击 "▶ 段落生成提示词" 展开/收起提示词编辑区域
- 可以自定义每个段落生成的提示词
- 支持多个占位符：
  - `{topic}` - 文章主题
  - `{outline}` - 完整大纲
  - `{current_section}` - 当前要生成的章节
  - `{context}` - 包含主题、大纲和之前内容的完整上下文
  - `{previous_content}` - 之前已生成的内容
- 点击 🔄 按钮可以重置为默认提示词

**使用示例**:
```
{context}

现在需要详细撰写以下部分：
{current_section}

要求：
1. 内容要详细、深入、富有技术性
2. 提供具体代码示例或配置说明
3. 与之前的内容保持连贯，避免重复
4. 使用 Markdown 格式，包含代码块
5. 篇幅控制在 500-1000 字之间
6. 只返回正文内容，不要包含章节标题

现在请撰写这一部分的内容：
```

## 使用流程

1. **输入主题**: 在顶部文本框输入文章主题
2. **编辑大纲提示词** (可选): 展开并自定义大纲生成提示词
3. **生成大纲**: 点击 "🎯 生成大纲" 按钮
4. **编辑段落提示词** (可选): 展开并自定义段落生成提示词
5. **选择生成模式**: 依次生成或一次性生成
6. **开始生成**: 点击 "✨ 开始生成内容" 按钮

## 技术实现

### 后端修改 (backend/app.py)

1. **`/api/generate-outline` 接口**:
   - 新增 `custom_prompt` 参数
   - 如果提供自定义提示词，使用自定义提示词并替换 `{topic}` 占位符
   - 否则使用默认提示词

2. **`/api/generate-section` 接口**:
   - 新增 `custom_prompt` 参数
   - 如果提供自定义提示词，替换多个占位符（topic, outline, current_section, context等）
   - 否则使用默认提示词

### 前端修改

1. **App.tsx**:
   - 添加提示词状态管理（outlinePrompt, sectionPrompt）
   - 添加显示/隐藏状态（showOutlinePrompt, showSectionPrompt）
   - 定义默认提示词常量
   - 在API调用时传递自定义提示词

2. **LeftPanel.tsx**:
   - 新增提示词相关props
   - 添加可折叠的提示词编辑区域
   - 提供重置按钮恢复默认提示词
   - 添加提示文字说明占位符用法

3. **LeftPanel.css**:
   - 新增提示词编辑区域样式
   - 添加折叠/展开动画效果
   - 使用等宽字体显示提示词文本
   - 美化重置按钮和提示信息

## 界面特点

- 🎨 **现代化设计**: 使用渐变色和圆角设计
- ✨ **流畅动画**: 折叠/展开有平滑过渡效果
- 💡 **智能提示**: 提供占位符使用说明
- 🔄 **快速重置**: 一键恢复默认提示词
- 📝 **等宽字体**: 提示词编辑使用代码编辑器风格字体

## 注意事项

1. 提示词编辑仅在未生成内容时可用（生成过程中禁用）
2. 占位符必须使用正确的格式（如 `{topic}` 而不是 `{TOPIC}` 或 `{{topic}}`）
3. 自定义提示词会完全替代默认提示词，请确保提示词包含必要的指令
4. 如果想要恢复默认行为，点击重置按钮或清空提示词

